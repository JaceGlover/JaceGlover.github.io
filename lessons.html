<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AceBlocks | Learn Roblox Lua</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  margin: 0;
  font-family: 'Montserrat', sans-serif;
  background: #0f172a;
  color: white;
}
header {
  padding: 20px;
  background: #111827;
  text-align: center;
}
header h1 { margin: 0; font-size: 2rem; }
.container {
  display: flex;
  height: calc(100vh - 80px);
}
#block-panel {
  width: 240px;
  background: #1e293b;
  padding: 10px;
  overflow-y: auto;
}
#block-panel h2 { font-size: 1.2rem; margin-top: 0; color: #38bdf8; }
.block-category { margin-bottom: 20px; }
.block { background: #334155; padding: 10px; margin: 5px 0; border-radius: 6px; cursor: grab; }
.block:hover { background: #475569; }
#workspace {
  flex: 1;
  background: #0f172a;
  padding: 20px;
  overflow-y: auto;
  border-left: 2px solid #38bdf8;
}
.workspace-block { background: #1e293b; padding: 10px; margin: 5px 0; border-radius: 6px; cursor: grab; }
.workspace-block.dragging { opacity: 0.5; }
button { background: #38bdf8; color: #0f172a; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; margin-top: 10px; }
button:hover { background: #60a5fa; }
#objective { padding: 10px; background: #1e293b; border-radius: 6px; margin-bottom: 10px; }
</style>
</head>
<body>

<header>
  <h1>AceBlocks | Learn Roblox Lua</h1>
</header>

<div class="container">
  <div id="block-panel">
    <h2>Movement</h2>
    <div class="block" data-code="player.WalkSpeed = VALUE">Set WalkSpeed</div>
    <div class="block" data-code="player.JumpPower = VALUE">Set JumpPower</div>
    <h2>Events</h2>
    <div class="block" data-code="game.Players.PlayerAdded:Connect(function(player)\n  -- code here\nend)">On Player Join</div>
    <div class="block" data-code="workspace.Touched:Connect(function(hit)\n  -- code here\nend)">On Touch</div>
    <h2>UI</h2>
    <div class="block" data-code="local gui = Instance.new('ScreenGui', player.PlayerGui)">Create GUI</div>
    <div class="block" data-code="local textLabel = Instance.new('TextLabel', gui)">Add TextLabel</div>
  </div>
  <div id="workspace">
    <div id="objective">Objective: Complete Lesson 1: Make your player move faster</div>
    <!-- Workspace blocks will appear here -->
  </div>
</div>

<div style="text-align:center;padding:10px;">
  <button id="runCode">Run Code</button>
  <button id="nextLesson">Next Lesson</button>
  <div id="output"></div>
</div>

<script>
// Basic lesson objectives
const lessons = [
  "Lesson 1: Make your player move faster",
  "Lesson 2: Make your player jump higher",
  "Lesson 3: Show a welcome message when a player joins",
  "Lesson 4: Detect when the player touches an object",
  "Lesson 5: Create a GUI for the player",
  "Lesson 6: Add a TextLabel to GUI",
  "Lesson 7: Change WalkSpeed with a variable",
  "Lesson 8: Change JumpPower with a variable",
  "Lesson 9: Connect multiple events",
  "Lesson 10: Make a stamina bar GUI",
  "Lesson 11: Print player's name on join",
  "Lesson 12: Combine movement + GUI + events"
];
let currentLesson = 0;

const objective = document.getElementById("objective");
function nextLessonFunc() {
  if(currentLesson < lessons.length - 1) {
    currentLesson++;
    objective.textContent = "Objective: " + lessons[currentLesson];
    workspace.innerHTML = "";
    updateWorkspaceDrag();
  } else {
    alert("All lessons completed!");
  }
}

// Drag & drop from panel to workspace
const blocks = document.querySelectorAll("#block-panel .block");
const workspace = document.getElementById("workspace");
blocks.forEach(block => {
  block.setAttribute("draggable","true");
  block.addEventListener("dragstart", e => {
    e.dataTransfer.setData("text/plain", block.dataset.code);
  });
});

// Drop blocks into workspace
workspace.addEventListener("dragover", e => e.preventDefault());
workspace.addEventListener("drop", e => {
  e.preventDefault();
  const code = e.dataTransfer.getData("text/plain");
  const newBlock = document.createElement("div");
  newBlock.className = "workspace-block";
  newBlock.setAttribute("draggable","true");
  newBlock.dataset.code = code;
  newBlock.textContent = code.split("\n")[0];
  workspace.appendChild(newBlock);
  updateWorkspaceDrag();
});

// Reorder workspace blocks
function updateWorkspaceDrag() {
  let draggedBlock = null;
  const wBlocks = workspace.querySelectorAll(".workspace-block");
  wBlocks.forEach(block => {
    block.addEventListener("dragstart", e => { draggedBlock = block; block.classList.add("dragging"); });
    block.addEventListener("dragend", e => { draggedBlock = null; block.classList.remove("dragging"); });
  });
  workspace.addEventListener("dragover", e => {
    e.preventDefault();
    const afterElement = getDragAfterElement(workspace, e.clientY);
    if(draggedBlock){
      if(afterElement == null) workspace.appendChild(draggedBlock);
      else workspace.insertBefore(draggedBlock, afterElement);
    }
  });
}
function getDragAfterElement(container, y){
  const draggableElements = [...container.querySelectorAll(".workspace-block:not(.dragging)")];
  return draggableElements.reduce((closest, child)=>{
    const box = child.getBoundingClientRect();
    const offset = y - box.top - box.height/2;
    if(offset < 0 && offset > closest.offset) return { offset: offset, element: child };
    else return closest;
  }, { offset: Number.NEGATIVE_INFINITY }).element;
}

// Simple code check system
document.getElementById("runCode").addEventListener("click", ()=>{
  const wBlocks = workspace.querySelectorAll(".workspace-block");
  const code = [...wBlocks].map(b=>b.dataset.code).join("\n");
  let success = false;
  switch(currentLesson){
    case 0: success = code.includes("WalkSpeed"); break;
    case 1: success = code.includes("JumpPower"); break;
    case 2: success = code.includes("PlayerAdded"); break;
    case 3: success = code.includes("Touched"); break;
    case 4: success = code.includes("ScreenGui"); break;
    case 5: success = code.includes("TextLabel"); break;
    default: success = true;
  }
  document.getElementById("output").textContent = success ? "✅ Objective Completed!" : "❌ Try Again!";
});

// Next lesson
document.getElementById("nextLesson").addEventListener("click", nextLessonFunc);
updateWorkspaceDrag();
</script>

</body>
</html>
