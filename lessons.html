<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AceBlocks Lessons</title>
<script src="https://unpkg.com/blockly/blockly.min.js"></script>

<style>
body{
margin:0;
font-family:Segoe UI, sans-serif;
background:#111827;
color:white;
text-align:center;
}

h1{
padding:20px;
}

#objective{
font-size:18px;
margin-bottom:10px;
color:#93c5fd;
}

#blocklyDiv{
height:400px;
width:100%;
background:white;
}

button{
background:#2563eb;
color:white;
border:none;
padding:10px 20px;
margin:15px;
cursor:pointer;
border-radius:6px;
font-weight:bold;
}

button:hover{
background:#1e40af;
}

#output{
margin-top:10px;
color:#10b981;
font-weight:bold;
min-height:20px;
}

/* CERTIFICATE */

#certificate{
display:none;
position:fixed;
inset:0;
background:white;
z-index:9999;
padding:40px;
}

.cert-content{
border:10px solid #2563eb;
height:100%;
position:relative;
text-align:center;
padding:80px 60px;
box-sizing:border-box;
color:black;
}

.cert-content h1{
font-size:48px;
margin-bottom:30px;
}

.cert-content h2{
font-size:36px;
margin:25px 0;
}

.signature-area{
position:absolute;
bottom:80px;
right:100px;
text-align:center;
}

.signature-img{
width:220px;
display:block;
margin:0 auto 8px auto;
}

.founder-name{
font-weight:bold;
margin:0;
font-size:18px;
}

.founder-title{
font-size:14px;
margin:0;
color:gray;
}

@media print{
body *{visibility:hidden;}
#certificate,#certificate *{visibility:visible;}
#certificate{
position:absolute;
left:0;
top:0;
}
}
</style>
</head>

<body>

<h1>AceBlocks Coding Lessons</h1>
<div id="objective"></div>

<div id="blocklyDiv"></div>

<button onclick="runCode()">Run</button>
<div id="output"></div>

<div id="nextSection" style="display:none;">
<br>
<input type="text" id="studentName" placeholder="Enter your name">
<br><br>
<button onclick="generateCertificate()">Generate Certificate</button>
</div>

<div id="certificate">
<div class="cert-content">
<h1>Certificate of Completion</h1>
<p>This certificate is proudly presented to</p>
<h2 id="certName">Student Name</h2>
<p>For successfully completing all 6 AceBlocks Coding Lessons</p>
<p id="certDate"></p>

<div class="signature-area">
<img src="signature_fixed_transparent.png" class="signature-img">
<p class="founder-name">Jace Glover</p>
<p class="founder-title">Founder, AceBlocks</p>
</div>
</div>
</div>

<script>

let currentLesson = 1;

const objectives = [
"Lesson 1: Print exactly 'Hello World'",
"Lesson 2: Print your name",
"Lesson 3: Print 'I love coding'",
"Lesson 4: Print a sentence with more than 3 words",
"Lesson 5: Print something with at least 10 characters",
"Lesson 6: Print any final message to complete the course"
];

document.getElementById("objective").innerText = objectives[0];

const workspace = Blockly.inject('blocklyDiv',{
toolbox:`
<xml>
  <block type="text_print"></block>
  <block type="text"></block>
</xml>
`
});

function runCode(){

const code = Blockly.JavaScript.workspaceToCode(workspace);

let printedText = "";

try{
const oldLog = console.log;
console.log = function(msg){
printedText = msg;
};
eval(code);
console.log = oldLog;
}catch(e){
document.getElementById("output").innerText = "Error in blocks!";
return;
}

if(checkLesson(printedText)){
document.getElementById("output").innerText = "Lesson Complete!";
currentLesson++;

workspace.clear();

if(currentLesson <= 6){
document.getElementById("objective").innerText = objectives[currentLesson-1];
}else{
document.getElementById("objective").innerText = "All Lessons Complete!";
document.getElementById("nextSection").style.display = "block";
}
}else{
document.getElementById("output").innerText = "Not quite! Try again.";
}

}

function checkLesson(text){

if(currentLesson === 1){
return text === "Hello World";
}
if(currentLesson === 2){
return text.trim().length > 0;
}
if(currentLesson === 3){
return text === "I love coding";
}
if(currentLesson === 4){
return text.split(" ").length > 3;
}
if(currentLesson === 5){
return text.length >= 10;
}
if(currentLesson === 6){
return text.trim().length > 0;
}

return false;
}

function generateCertificate(){

const nameInput = document.getElementById("studentName");

if(nameInput.value.trim() === ""){
alert("Please enter your name.");
return;
}

document.getElementById("certName").innerText = nameInput.value;
document.getElementById("certDate").innerText =
"Date: " + new Date().toLocaleDateString();

document.getElementById("certificate").style.display = "block";
}

</script>

</body>
</html>
